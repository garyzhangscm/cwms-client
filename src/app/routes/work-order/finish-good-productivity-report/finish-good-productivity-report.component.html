<page-header title="{{'finish-good-productivity-report' |  i18n}}" ></page-header>




<nz-spin [nzSpinning]="isSpinning" [nzSize]="'large'">

  <div *ngIf="lightMESConfiguration == null">

    <nz-result nzStatus="warning" [nzIcon]="'info-circle'" nzTitle="{{'light MES Configuration is not setup' | i18n}}"> 
      <div nz-result-extra>
        please go to <a routerLink="/work-order/light-mes-configuration" routerLinkActive="active">Light MES Configuration</a> page to setup the configuration
      </div>
    </nz-result>
  </div>


  <nz-card  *ngIf="lightMESConfiguration != null" [nzExtra]="showConfigurationTemplate"
       nzTitle="Count down: {{ countDownNumber }}">
       
    <ng-template #showConfigurationTemplate>
        
        <span style="padding-right: 10px">Hours Spend on this shift: 
            <strong>{{hoursSpentInThisShift | number: '1.0-2'}}</strong>
        </span>
        <span style="padding-right: 10px">current time: 
            <strong>{{currentTime}}</strong></span>
        <span style="padding-right: 10px">(current shift: 
            <strong>[{{currentShiftStartTime }} - {{currentShiftEndTime  }}]</strong>)</span>
        <label nz-checkbox [(ngModel)]="showConfiguration" >
          <span> {{ 'showConfiguration' | i18n }}</span>
        </label>
    </ng-template>
    <div *ngIf="showConfiguration" style="padding: 10px">
        {{'item-family' | i18n}}: <nz-radio-group [(ngModel)]="selectedItemFamily" (ngModelChange)="itemFamilyChanged()">
          <label nz-radio nzValue="All">All</label>
          <label nz-radio *ngFor="let itemFamily of itemFamilies" [nzValue]="itemFamily.name">{{itemFamily.name}}</label> 
        </nz-radio-group>
        
        <span style="padding-left: 20px">Refresh Cycle(in seconds): </span>
        <nz-input-number   [nzMin]="1" [nzMax]="9999" [nzStep]="1"   [(ngModel)]="refreshCountCycle" (ngModelChange)="refreshCountCycleChanged()" >
        </nz-input-number> 

    </div> 
    <st #st [data]="itemProductivityReports"  [columns]="columns" >
        <ng-template st-row="productionLineColumn" let-itemProductivity let-index="index"> 
             <p *ngFor="let productionLineName of itemProductivity.productionLineNames">
                  {{ productionLineName }}
             </p>
        </ng-template>
        <ng-template st-row="finishRateColumn" let-itemProductivity  > 
          {{  itemProductivity.finishRate |  percent: '1.0-2'}} 
        </ng-template>
        <ng-template st-row="estimatedFinishRateColumn" let-itemProductivity  > 
          {{  itemProductivity.estimatedFinishRate | percent: '1.0-2'}} 
        </ng-template>

    </st> 
  </nz-card>
</nz-spin>